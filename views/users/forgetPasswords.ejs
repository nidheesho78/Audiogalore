<%- include('../layouts/userHeader.ejs') %>






<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">

</head>
<body>


  <div class="form-container" style="margin-top: 180px; max-width: 400px; margin: 0 auto; margin-top: 180px; margin-bottom: 80px;">
    <h3 style="text-align: center;">Mobile Number Verification</h3>
    <form id="myForm" action="/setNewPassword" method="post" style="margin-top: 30px;" onsubmit="return validateForm()">
      <div class="form-group">
        <label for="mobileNumber">Mobile Number:</label>
        <input type="text" id="mobileNumber" name="mobile" value="<%=(typeof mobile!=='undefined')?mobile:'' %>" placeholder="Enter your mobile number" style="width: 100%; padding: 10px;">
      </div>
      <div class="form-group" style="text-align: center;">
        <a href="/forgotPasswordOtp?mobileNumber=" onclick="sendOTP(event)" class="btn" style="background-color: gray; color: white; padding: 10px 20px; text-decoration: none; border-radius: 4px;">Send OTP</a>
      </div>
      <div class="form-group">
        <label for="otp">Enter OTP:</label>
        <input type="text" id="otp" name="otp" placeholder="Enter the OTP you received" style="width: 100%; padding: 10px;">
      </div>
      <div class="form-group" style="text-align: center;">
        <button type="submit" class="btn" style="background-color: #4CAF50; color: white; padding: 10px 20px; text-decoration: none; border-radius: 4px; cursor: pointer;">Submit</button>
        <p ><%=(typeof message!=='undefined')?message:'' %></p>
         <p id="errorMessage" style="color: red; margin-top: 10px;"></p>
         <div class="col-md-12 form-group form-group-spacing">
                                    <a href="/resendOtp">
                                        <p type="button" class="btn resend_btn" id="resendBtn"
                                            style="display: none; color: rgb(49, 156, 72);">Resend OTP</p>
                                    </a>

                                   <p style="color: red;">
                                          <%=(typeof message!=='undefined') ? message : "" %>
                                                  </p>


                                </div>
                                <div class="col-md-12 form-group form-group-spacing">
                                    <p id="countdown" style="display: none;"></p>
                                </div>
      </div>
    </form>
  </div>
  
  <script>
    function sendOTP(event) {
      event.preventDefault(); // Prevent default link behavior
      
      var mobileNumberInput = document.getElementById('mobileNumber');
      var mobileNumber = mobileNumberInput.value.trim();
      
      var mobileNumberPattern = /^\+?[0-9]{1,12}$/;
      
      if (mobileNumber === '') {
        document.getElementById('errorMessage').textContent = 'Please enter your mobile number.';
      } else if (!mobileNumberPattern.test(mobileNumber)) {
        document.getElementById('errorMessage').textContent = 'Invalid mobile number format.';
      } else {
        var sendOTPUrl = '/forgotPasswordOtp?mobileNumber=' + encodeURIComponent(mobileNumber);
        window.location.href = sendOTPUrl;
      }
    }
  </script>


<script>
  function validateForm() {
    var mobileInput = document.getElementById("mobileNumber");
    var otpInput = document.getElementById("otp");

    // Trim the input values
    var mobileValue = mobileInput.value.trim();
    var otpValue = otpInput.value.trim();

    // Check if any input is empty
    if (mobileValue === "" || otpValue === "") {
      document.getElementById("errorMessage").textContent = "All fields are required";
      return false; // Prevent form submission
    }

    // Form is valid, allow submission
    return true;
  }
</script>
 <script>
        // Wait for 5 seconds before showing the resend button
        setTimeout(function () {
            document.getElementById("resendBtn").style.display = "block";
        }, 5000);

        // Countdown timer
        var countdownElement = document.getElementById("countdown");
        var timeLeft = 5; // Set the time in seconds

        function startCountdown() {
            countdownElement.style.display = "block";
            countdownElement.textContent = "Resend OTP in " + timeLeft + " seconds";
            timeLeft--;

            if (timeLeft >= 0) {
                setTimeout(startCountdown, 1000); // Update every second
            } else {
                countdownElement.style.display = "none";
            }
        }

        startCountdown();
    </script>
  


  




    <%- include('../layouts/userFooter.ejs') %>