<%- include('../layouts/userHeader.ejs') %>

<!-- ... (rest of your code) ... -->

<div class="form-container" style="margin-top: 180px; max-width: 400px; margin: 0 auto; margin-top: 180px; margin-bottom: 80px;">
    <h3 style="text-align: center;">Mobile Number Verification</h3>
    <form id="myForm" action="/sendOtp" method="post" style="margin-top: 30px;" onsubmit="return validateMobileForm()">
        <div class="form-group">
            <label for="mobileNumber">Mobile Number:</label>
            <input type="text" id="mobileNumber" name="mobile" value="<%=(typeof mobile!=='undefined')?mobile:'' %>"
                placeholder="Enter your mobile number" style="width: 100%; padding: 10px;">
        </div>
        <div class="form-group" style="text-align: center;">
             <a href="/forgotPasswordOtp?mobileNumber=" onclick="sendOTP(event)" class="btn" style="background-color: gray; color: white; padding: 10px 20px; text-decoration: none; border-radius: 4px;">Send OTP</a>
        </div>
        <p id="errorMessage" style="color: red; margin-top: 10px;"></p>
    </form>
</div>

<script>
    function validateMobileForm() {
        var mobileNumberInput = document.getElementById("mobileNumber");
        var mobileNumber = mobileNumberInput.value.trim();

        var mobileNumberPattern = /^\+?[0-9]{1,12}$/;

        if (mobileNumber === "") {
            document.getElementById("errorMessage").textContent = "Please enter your mobile number.";
            return false; // Prevent form submission
        } else if (!mobileNumberPattern.test(mobileNumber)) {
            document.getElementById("errorMessage").textContent = "Invalid mobile number format.";
            return false; // Prevent form submission
        }

        // Form is valid, allow submission
        return true;
    }
</script>
<script>
    function sendOTP(event) {
      event.preventDefault(); // Prevent default link behavior
      
      var mobileNumberInput = document.getElementById('mobileNumber');
      var mobileNumber = mobileNumberInput.value.trim();
      
      var mobileNumberPattern = /^\+?[0-9]{1,12}$/;
      
      if (mobileNumber === '') {
        document.getElementById('errorMessage').textContent = 'Please enter your mobile number.';
      } else if (!mobileNumberPattern.test(mobileNumber)) {
        document.getElementById('errorMessage').textContent = 'Invalid mobile number format.';
      } else {
        var sendOTPUrl = '/forgotPasswordOtp?mobileNumber=' + encodeURIComponent(mobileNumber);
        window.location.href = sendOTPUrl;
      }
    }
  </script>

<%- include('../layouts/userFooter.ejs') %>
